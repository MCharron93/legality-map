<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Animated United States map made with Raphael</title>
  <link rel="stylesheet" href="demo-animated.css">
</head>

<body>

  <div id="container"></div>
  <!-- /container -->

  <div id="modal-one" class="hidden">
    <div class="modal-header">
      <h4>Alabama</h4>
    </div>
    <div class="modal-body">
      <p>The new legislation, Senate Bill 226, was sponsored by Republican Senator Arthur Orr at the beginning of
        February 2016. And within a few months, the bill passed on May 4th, 2016. Then, a few days later, on May 10th,
        2016, Alabama State Governor Robert Bentley signed the legislation into law.
        <br>
        The bill itself states:

        “New synthetic substances are being created which are not controlled under the provisions of existing state law
        but which have a potential for abuse similar to or greater than that for substances controlled under existing
        state law. These new synthetic substances are called ‘synthetic controlled substances or synthetic controlled
        substance analogues’ and can be designed to produce a desired pharmacological effect and to evade the
        controlling statutory provisions. Synthetic controlled substances or synthetic controlled substance analogues
        are being manufactured, distributed, possessed, and used as substitutes for controlled substances.”

        And it goes on to list mitragynine and hydroxymitragynine (sic) within the bill for synthetic substances.
        However, neither mitragynine nor 7-hydroxymitragynine is a synthetic compound. Both are naturally occurring
        alkaloids found in the kratom plant. Still, even though kratom compounds are not synthetic, the state law
        continues to view kratom products and the plant as an illegal substance in Alabama at this time. The addition of
        both molecules added onto the bill cements the ban.
      </p>
    </div>
  </div>

  <script src="raphael-min.js"></script>
  <script src="./us-map-svg.js"></script>
  <script>

    // Creates the map onLoad with default colour values
    window.onload = function () {
      // console.log("Hello from onLoad")

      var R = Raphael("container", 1000, 900),
        attr = {
          "fill": "#d3d3d3",
          "stroke": "#fff",
          "stroke-opacity": "1",
          "stroke-linejoin": "round",
          "stroke-miterlimit": "4",
          "stroke-width": "0.75",
          "stroke-dasharray": "none"
        },
        usRaphael = {};

      //Draw Map and store Raphael paths
      for (var state in usMap) {
        // console.log("hello from state in usMap")
        usRaphael[state] = R.path(usMap[state]).attr(attr);
      }

      //Do Work on Map
      for (var state in usRaphael) {
        // console.log("hello from state in usRaphael")

        (function (st, state) {
          // Draws changes when creating the map, st[0] is the whatever state the user is currently on

          st[0].style.cursor = "pointer";

          // Changes the colour on mouseover, can be changed to any color
          st[0].onmouseover = function () {
            // Redraws the element with the desired color
            // console.log(state)
            if (state != "al" && state != "ar" && state != "wi" && state != "in" && state != "vt" && state != "ri") {
              st.animate({ fill: "green" }, 500);
              st.toFront();
              R.safari();
            }
            else {
              st.animate({ fill: "red" }, 500);
              st.toFront();
              R.safari();
            }

          };

          st[0].onmouseout = function () {
            // console.log("hello from mouseout")
            st.animate({ fill: "#d3d3d3" }, 500);
            st.toFront();
            R.safari();
          };

          // NOTE new section to handle onclick events with mouse
          st[0].onclick = function () {
            // console.log(state)
            // let modal = document.getElementById('modal-one')
            // console.log(modal)
            // modal.remove("hidden")
            handleClick(st, state)
          }

        })(usRaphael[state], state);
      }

    };

    function handleClick(position, state) {
      console.log(state)
      let modal = document.getElementById('modal-one')
      console.log(modal)
      modal.remove("hidden")
    }
  </script>
</body>

</html>